# æ•°æ®åº“è®¾è®¡ä¸åŠŸèƒ½å®Œå–„ - å®æ–½æ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. æ•°æ®åº“åŸºç¡€æ¶æ„ âœ…
- âœ… å®‰è£…ä¾èµ–ï¼šSQLAlchemy, Alembic, bcrypt, python-jose
- âœ… åˆ›å»ºæ•°æ®åº“æ¨¡å— (`database/`)
  - `database.py`: æ•°æ®åº“è¿æ¥å’Œä¼šè¯ç®¡ç†
  - `models.py`: SQLAlchemy æ¨¡å‹å®šä¹‰ï¼ˆ7ä¸ªè¡¨ï¼‰
- âœ… é…ç½® Alembic è¿ç§»å·¥å…·
- âœ… æ•°æ®åº“è‡ªåŠ¨åˆå§‹åŒ–

### 2. è®¤è¯ç³»ç»Ÿ âœ…
- âœ… JWT è®¤è¯å®ç° (`auth/`)
- âœ… ç”¨æˆ·æ³¨å†Œ/ç™»å½• API (`routers/auth.py`)
- âœ… å¯†ç åŠ å¯†ï¼ˆbcryptï¼‰
- âœ… å‰ç«¯ç™»å½•é¡µé¢ (`pages/Login.tsx`)
- âœ… Token ç®¡ç†å’Œè·¯ç”±å®ˆå« (`hooks/useAuth.ts`)

### 3. è§’è‰²ç®¡ç† API âœ…
- âœ… è§’è‰² CRUD API (`routers/characters.py`)
- âœ… å£°éŸ³é…ç½®ç®¡ç†ï¼ˆæ·»åŠ /æ›´æ–°/åˆ é™¤ï¼‰
- âœ… é»˜è®¤å£°éŸ³è®¾ç½®
- âœ… è§’è‰²ä¸æ¨¡å‹å…³è”ï¼ˆLLMæ¨¡å‹ã€3Dæ¨¡å‹ï¼‰

### 4. æ¨¡å‹ç®¡ç† API âœ…
- âœ… LLMæ¨¡å‹ç®¡ç† (`routers/models.py`)
  - CRUD æ“ä½œ
  - é»˜è®¤æ¨¡å‹è®¾ç½®
  - æ”¯æŒ Anthropicã€OpenAIã€è‡ªå®šä¹‰
- âœ… 3Dæ¨¡å‹ç®¡ç†
  - CRUD æ“ä½œ
  - æ–‡ä»¶ä¸Šä¼ ï¼ˆVRM/GLBï¼‰
  - é»˜è®¤æ¨¡å‹è®¾ç½®

### 5. ç³»ç»Ÿè®¾ç½® API âœ…
- âœ… ç³»ç»Ÿé…ç½®ç®¡ç† (`routers/settings.py`)
- âœ… åˆ†ç±»ç®¡ç†ï¼ˆtts, llm, generalï¼‰
- âœ… ä»…ç®¡ç†å‘˜å¯è®¿é—®

### 6. å‰ç«¯å®ç° âœ…
- âœ… ç±»å‹å®šä¹‰æ‰©å±• (`types.ts`)
- âœ… API å®¢æˆ·ç«¯ (`api/`)
  - `authApi.ts`: è®¤è¯
  - `charactersApi.ts`: è§’è‰²ç®¡ç†
  - `modelsApi.ts`: æ¨¡å‹ç®¡ç†
  - `settingsApi.ts`: ç³»ç»Ÿè®¾ç½®
- âœ… è§’è‰²ç®¡ç†é¡µé¢é‡æ„ (`pages/Characters.tsx`)
  - å£°éŸ³åˆ—è¡¨ç®¡ç†
  - æ¨¡å‹é€‰æ‹©
  - UI ä¼˜åŒ–
- âœ… ç³»ç»Ÿè®¾ç½®é¡µé¢å®ç° (`pages/Settings.tsx`)
  - AIæ¨¡å‹ç®¡ç†
  - 3Dæ¨¡å‹ç®¡ç†
  - ç³»ç»Ÿé…ç½®ç®¡ç†
- âœ… ç™»å½•é¡µé¢ (`pages/Login.tsx`)
- âœ… è·¯ç”±å®ˆå«å’Œè®¤è¯çŠ¶æ€ç®¡ç†

### 7. æ•°æ®è¿ç§» âœ…
- âœ… åˆå§‹åŒ–è„šæœ¬ (`migrations/init_data.py`)
- âœ… localStorage è¿ç§»è„šæœ¬ (`migrations/migrate_localstorage.py`)

### 8. ç›´æ’­æœåŠ¡æ›´æ–° âœ…
- âœ… ä½¿ç”¨æ•°æ®åº“ä¸­çš„è§’è‰²å’Œé…ç½®
- âœ… è‡ªåŠ¨å…³è”å£°éŸ³é…ç½®å’ŒLLMæ¨¡å‹
- âœ… åˆ›å»ºç›´æ’­ä¼šè¯è®°å½•

## ğŸ“Š æ•°æ®åº“è¡¨ç»“æ„

1. **users** - ç”¨æˆ·è¡¨
2. **characters** - è§’è‰²è¡¨
3. **voice_configs** - å£°éŸ³é…ç½®è¡¨
4. **llm_models** - LLMæ¨¡å‹è¡¨
5. **vtuber_3d_models** - 3Dæ¨¡å‹è¡¨
6. **live_sessions** - ç›´æ’­ä¼šè¯è¡¨
7. **system_settings** - ç³»ç»Ÿé…ç½®è¡¨

## ğŸš€ ä½¿ç”¨æŒ‡å—

### é¦–æ¬¡å¯åŠ¨

1. **å®‰è£…ä¾èµ–**
   ```bash
   pip install -r requirements.txt
   ```

2. **å¯åŠ¨åç«¯**
   ```bash
   cd echuu-web/backend
   python main.py
   ```
   
   é¦–æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨ï¼š
   - åˆ›å»ºæ•°æ®åº“æ–‡ä»¶
   - åˆ›å»ºæ‰€æœ‰è¡¨
   - åˆå§‹åŒ–é»˜è®¤æ•°æ®ï¼ˆadmin/admin123ï¼‰

3. **å¯åŠ¨å‰ç«¯**
   ```bash
   cd echuu-web/frontend
   npm install
   npm run dev
   ```

4. **ç™»å½•**
   - è®¿é—® http://localhost:5173
   - ä½¿ç”¨é»˜è®¤è´¦æˆ·ï¼š`admin` / `admin123`
   - æˆ–æ³¨å†Œæ–°è´¦æˆ·

### åŠŸèƒ½ä½¿ç”¨

#### è§’è‰²ç®¡ç†
1. è¿›å…¥"è§’è‰²ç®¡ç†"é¡µé¢
2. åˆ›å»ºè§’è‰²ï¼Œå¡«å†™åç§°ã€äººè®¾ã€èƒŒæ™¯
3. ä¸ºè§’è‰²æ·»åŠ å£°éŸ³é…ç½®ï¼ˆå¯é€‰æ‹©å¤šä¸ªï¼Œè®¾ç½®é»˜è®¤ï¼‰
4. é€‰æ‹©é»˜è®¤ LLM æ¨¡å‹å’Œ 3D æ¨¡å‹

#### æ¨¡å‹ç®¡ç†ï¼ˆç®¡ç†å‘˜ï¼‰
1. è¿›å…¥"ç³»ç»Ÿè®¾ç½®" â†’ "LLM æ¨¡å‹"
2. æ·»åŠ /ç¼–è¾‘/åˆ é™¤ LLM æ¨¡å‹
3. åˆ‡æ¢åˆ°"3D æ¨¡å‹"æ ‡ç­¾é¡µ
4. ä¸Šä¼ æˆ–é…ç½® 3D æ¨¡å‹æ–‡ä»¶

#### å¯åŠ¨ç›´æ’­
1. è¿›å…¥"ç›´æ’­ç›‘æ§"é¡µé¢
2. é€‰æ‹©è§’è‰²ï¼ˆä¼šè‡ªåŠ¨ä½¿ç”¨è§’è‰²çš„é»˜è®¤å£°éŸ³å’Œæ¨¡å‹ï¼‰
3. è¾“å…¥ç›´æ’­ä¸»é¢˜
4. ç‚¹å‡»"å¼€å§‹ç›´æ’­"

## ğŸ” å®‰å…¨è¯´æ˜

- é»˜è®¤ç®¡ç†å‘˜å¯†ç ï¼š`admin123`ï¼ˆ**ç”Ÿäº§ç¯å¢ƒè¯·ä¿®æ”¹ï¼**ï¼‰
- JWT Token æœ‰æ•ˆæœŸï¼š7å¤©
- API è·¯ç”±éœ€è¦è®¤è¯ï¼ˆé™¤ç™»å½•/æ³¨å†Œå¤–ï¼‰
- æ•æ„Ÿæ“ä½œï¼ˆæ¨¡å‹ç®¡ç†ã€ç³»ç»Ÿè®¾ç½®ï¼‰éœ€è¦ç®¡ç†å‘˜æƒé™

## ğŸ“ API ç«¯ç‚¹

### è®¤è¯
- `POST /api/auth/register` - æ³¨å†Œ
- `POST /api/auth/login` - ç™»å½•
- `GET /api/auth/me` - è·å–å½“å‰ç”¨æˆ·

### è§’è‰²ç®¡ç†
- `GET /api/characters` - è·å–è§’è‰²åˆ—è¡¨
- `POST /api/characters` - åˆ›å»ºè§’è‰²
- `PUT /api/characters/{id}` - æ›´æ–°è§’è‰²
- `DELETE /api/characters/{id}` - åˆ é™¤è§’è‰²
- `POST /api/characters/{id}/voices` - æ·»åŠ å£°éŸ³é…ç½®
- `PUT /api/characters/{id}/voices/{voice_id}` - æ›´æ–°å£°éŸ³é…ç½®
- `DELETE /api/characters/{id}/voices/{voice_id}` - åˆ é™¤å£°éŸ³é…ç½®

### æ¨¡å‹ç®¡ç†ï¼ˆç®¡ç†å‘˜ï¼‰
- `GET /api/models/llm` - è·å–LLMæ¨¡å‹åˆ—è¡¨
- `POST /api/models/llm` - åˆ›å»ºLLMæ¨¡å‹
- `PUT /api/models/llm/{id}` - æ›´æ–°LLMæ¨¡å‹
- `DELETE /api/models/llm/{id}` - åˆ é™¤LLMæ¨¡å‹
- `GET /api/models/3d` - è·å–3Dæ¨¡å‹åˆ—è¡¨
- `POST /api/models/3d/upload` - ä¸Šä¼ 3Dæ¨¡å‹
- `POST /api/models/3d` - åˆ›å»º3Dæ¨¡å‹
- `PUT /api/models/3d/{id}` - æ›´æ–°3Dæ¨¡å‹
- `DELETE /api/models/3d/{id}` - åˆ é™¤3Dæ¨¡å‹

### ç³»ç»Ÿè®¾ç½®ï¼ˆç®¡ç†å‘˜ï¼‰
- `GET /api/settings` - è·å–ç³»ç»Ÿè®¾ç½®
- `POST /api/settings` - åˆ›å»ºè®¾ç½®é¡¹
- `PUT /api/settings/{key}` - æ›´æ–°è®¾ç½®é¡¹
- `DELETE /api/settings/{key}` - åˆ é™¤è®¾ç½®é¡¹

## ğŸ”„ æ•°æ®è¿ç§»

### ä» localStorage è¿ç§»è§’è‰²

1. åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œï¼š
   ```javascript
   localStorage.getItem('echuu.characters')
   ```
2. å¤åˆ¶è¾“å‡ºçš„ JSON æ•°æ®
3. è¿è¡Œè¿ç§»è„šæœ¬ï¼š
   ```bash
   cd echuu-web/backend
   python migrations/migrate_localstorage.py
   ```
4. ç²˜è´´ JSON æ•°æ®

## ğŸ“ æ–°å¢æ–‡ä»¶æ¸…å•

### åç«¯
- `database/models.py` - æ•°æ®åº“æ¨¡å‹
- `database/database.py` - æ•°æ®åº“è¿æ¥
- `auth/auth.py` - è®¤è¯é€»è¾‘
- `auth/dependencies.py` - ä¾èµ–æ³¨å…¥
- `routers/auth.py` - è®¤è¯è·¯ç”±
- `routers/characters.py` - è§’è‰²ç®¡ç†è·¯ç”±
- `routers/models.py` - æ¨¡å‹ç®¡ç†è·¯ç”±
- `routers/settings.py` - ç³»ç»Ÿè®¾ç½®è·¯ç”±
- `migrations/init_data.py` - åˆå§‹åŒ–è„šæœ¬
- `migrations/migrate_localstorage.py` - è¿ç§»è„šæœ¬
- `alembic.ini` - Alembic é…ç½®
- `alembic/env.py` - Alembic ç¯å¢ƒ

### å‰ç«¯
- `pages/Login.tsx` - ç™»å½•é¡µé¢
- `api/authApi.ts` - è®¤è¯ API
- `api/charactersApi.ts` - è§’è‰² API
- `api/modelsApi.ts` - æ¨¡å‹ API
- `api/settingsApi.ts` - è®¾ç½® API
- `hooks/useAuth.ts` - è®¤è¯ Hook
- `data/voices.ts` - éŸ³è‰²åˆ—è¡¨
- `lib/utils.ts` - å·¥å…·å‡½æ•°

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®åº“æ–‡ä»¶ä½ç½®**ï¼š`echuu-web/backend/data/echuu.db`
2. **é¦–æ¬¡å¯åŠ¨**ï¼šä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“å’Œé»˜è®¤æ•°æ®
3. **ç”Ÿäº§ç¯å¢ƒ**ï¼šåŠ¡å¿…ä¿®æ”¹é»˜è®¤å¯†ç å’Œ SECRET_KEY
4. **3Dæ¨¡å‹å­˜å‚¨**ï¼š`echuu-web/backend/storage/models/`
5. **å‘åå…¼å®¹**ï¼šæ—§çš„ API è°ƒç”¨æ–¹å¼ä»ç„¶æ”¯æŒï¼ˆä½†æ¨èä½¿ç”¨æ–°çš„ï¼‰

## ğŸ¯ æ ¸å¿ƒæ”¹è¿›

1. âœ… **æ•°æ®æŒä¹…åŒ–**ï¼šä» localStorage è¿ç§»åˆ° SQLite æ•°æ®åº“
2. âœ… **ç”¨æˆ·ç³»ç»Ÿ**ï¼šæ”¯æŒå¤šç”¨æˆ·ã€æƒé™ç®¡ç†
3. âœ… **å£°éŸ³åˆ—è¡¨**ï¼šæ¯ä¸ªè§’è‰²å¯ä»¥æœ‰å¤šä¸ªå£°éŸ³é…ç½®
4. âœ… **æ¨¡å‹å¯æ›¿æ¢**ï¼šAIæ¨¡å‹å’Œ3Dæ¨¡å‹å¯åœ¨ç•Œé¢ä¸­ç®¡ç†
5. âœ… **å…³ç³»å‹æ•°æ®**ï¼šå»ºç«‹äº†å®Œæ•´çš„å…³è”å…³ç³»
6. âœ… **å®‰å…¨æ€§**ï¼šJWT è®¤è¯ã€å¯†ç åŠ å¯†ã€æƒé™æ§åˆ¶

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æ•°æ®åº“è®¾ç½®è¯´æ˜](./DATABASE_SETUP.md)
- [åç«¯ README](./backend/README.md)
- [å¯åŠ¨æŒ‡å—](./README.md)
